{% extends ('admin/base.html.twig') %}

{% block main %}
    <main id="update-piece">
    <a href="{{ path('admin-list-pieces') }}" class="btn btn-primary mb-3">&#8592; Retour à la gestion des pièces</a>
    <h1 class="modif-piece">Modifier la pièce</h1>
    <form method="post" action="{{ path('admin-update-piece', {'id': piece.id}) }}">
        <input type="hidden" name="_token" value="{{ csrf_token('update_piece' ~ piece.id) }}">
        <table class="table table-bordered" style="width:80%; margin:auto;">
            <tbody>
                <tr>
                    <th>Catégorie</th>
                <td>
                    <select name="categoryId" class="form-control" required>
                        <option value="">Sélectionner une catégorie</option>
                    {% for category in categories %}
                        <option value="{{ category.id }}" {% if piece.category and piece.category.id == category.id %}selected{% endif %}>
                    {{ category.name }}
                        </option>
                    {% endfor %}
                    </select>
                </td>
                </tr>
                <tr>
                    <th>Nom</th>
                    <td>
                        <input type="text" name="name" class="form-control" value="{{ piece.name }}" required>
                    </td>
                </tr>
                <tr>
                    <th>Description</th>
                    <td>
                        <textarea name="description" class="form-control" required>{{ piece.description }}</textarea>
                    </td>
                </tr>
                <tr>
                    <th>Prix (€)</th>
                    <td>
                        <input type="number" name="price" class="form-control" value="{{ piece.price }}" required>
                    </td>
                </tr>
                <tr>
                    <th>Image</th>
                    <td>
                        <input type="file" name="image" class="form-control">
                        {% if piece.image %}
                            <img src="{{ asset('uploads/images/' ~ piece.image) }}" alt="{{ piece.name }}" style="max-width: 120px; max-height: 120px; margin-top: 10px;">
                        {% endif %}
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="mt-3 d-flex gap-3 justify-content-center">
            <button type="submit" class="btn btn-warning">Confirmer la modification</button>
            <a href="{{ path('admin-list-pieces') }}" class="btn btn-primary">Annuler</a>
        </div>
    </form>
</main>
{% endblock main %}